# Load data from Amerilife_STG sConnection <- "Driver = {SQL Server}; Server = FL-TPA-BI-01.alg.local; Database = Amerilife_STG;" sQuery <- "select * from staging.SSAS_Discovery_Typed" dsDiscovery <- RxSqlServerData(sqlquery = sQuery, connectionString = sConnection, rowsPerRead = 10000)
dsDiscovery <- RxSqlServerData(connectionString = sConnection, table = "staging.SSAS_Discovery_Typed", rowsPerRead = 10000)
?RxSqlServerData
dsDiscovery <- RxSqlServerData(connectionString = sConnection, table = "staging.SSAS_Discovery_Typed", rowsPerRead = 10000, Trusted_Connection)
sConnection <- "Driver = {SQL Server}; Server = FL-TPA-BI-01.alg.local; Database = Amerilife_STG; UID = SQLserverR_user; PWD = Amerilife01"
sQuery <- "select * from staging.SSAS_Discovery_Typed"
dsDiscovery <- RxSqlServerData(connectionString = sConnection, table = "staging.SSAS_Discovery_Typed", rowsPerRead = 10000)
str(dsDiscovery)
head(dsDiscovery)
sConnection <- "Driver=SQL Server;Server=FL-TPA-BI-01.alg.local;Database=Amerilife_STG;UID=SQLserverR_user;PWD=Amerilife01"
sQuery <- "select * from staging.SSAS_Discovery_Typed"
dsDiscovery <- RxSqlServerData(connectionString = sConnection, table = "staging.SSAS_Discovery_Typed", rowsPerRead = 10000)
head(dsDiscovery)
rxGetVarInfo(data = dsDiscovery)
getwd()
rxDataStep(inData = dsDiscovery, outFile = "./data/DiscoveryAgents.xdf")
dsDiscovery <- RxSqlServerData(connectionString = sConnection, table = sTable, rowsPerRead = 10000, stringsAsFactors = TRUE)
sConnection <- "Driver=SQL Server;Server=FL-TPA-BI-01.alg.local;Database=Amerilife_STG;UID=SQLserverR_user;PWD=Amerilife01"
# sQuery <- "select * from staging.SSAS_Discovery_Typed"
sTable <- "staging.SSAS_Discovery_Typed"
dsDiscovery <- RxSqlServerData(connectionString = sConnection, table = sTable, rowsPerRead = 10000, stringsAsFactors = TRUE)
rxGetVarInfo(data = dsDiscovery)
rxDataStep(inData = dsDiscovery, outFile = "./data/DiscoveryAgents.xdf", overwrite = TRUE)
rxGetVarInfo(data = dsDiscovery)
str(dsDiscovery)
str(dsDiscovery)
head(dsDiscovery)
summary(dsDiscovery)
rxSummary(dsDiscovery)
rxSummary(~., data = dsDiscovery)
dsDiscovery <- rxImport(inData = "./data/DiscoveryAgents.xdf")
str(dsDiscovery)
summary(dsDiscovery)
levels(dsDiscovery$MarketingCompany)
levels(dsDiscovery$Marketer)
sort(levels(dsDiscovery$Marketer))
sort(levels(dsDiscovery$Agent))
dsDiscovery[dsDiscovery$Agent = "Unknown", ]
dsDiscovery[dsDiscovery$Agent == "Unknown", ]
dsDiscovery$Agent == "Unknown"
dsDiscovery[dsDiscovery$Agent == "Unknown"] <- NA
dsDiscovery[dsDiscovery$Agent == "Unknown"]$Agent <- NA
dsDiscovery[dsDiscovery$Agent == "Unknown",]$Agent <- NA
dsDiscovery[dsDiscovery$Agent == "Unknown",]
head(dsDiscovery)
dsDiscovery <- rxImport(inData = "./data/DiscoveryAgents.xdf")
dsDiscovery[dsDiscovery$Agent == "Unknown",]
dsDiscovery$Agent[dsDiscovery$Agent == "Unknown"] <- NA
dsDiscovery
dsDiscovery[dsDiscovery$Agent == "Unknown"]
dsDiscovery[dsDiscovery$Agent == "Unknown",]
head(dsDiscovery)
dsDiscovery <- rxImport(inData = "./data/DiscoveryAgents.xdf")
# Examine the data
str(dsDiscovery)
table(dsDiscovery$CRMGender)
dsDiscovery$CRMGender[dsDiscovery$CRMGender == "U"] <- NA
table(dsDiscovery$CRMGender)
dsDiscovery[dsDiscovery$CRMGender == "U",]
dsDiscovery <- rxImport(inData = "./data/DiscoveryAgents.xdf")
?rxImport
library(gdata)
dsDiscovery <- rxImport(inData = "./data/DiscoveryAgents.xdf")
head(dsDiscovery)
dsDiscovery[dsDiscovery$CRMGender == "Unknown"]
dsDiscovery[dsDiscovery$CRMGender == "Unknown",]
dsDiscovery[dsDiscovery$CRMGender == "Unknown",]$CRMGender
head(dsDiscovery)
table(dsDiscovery$CRMGender)
dsDiscovery[dsDiscovery$CRMGender == "Unknown",]$CRMGender <- NA
table(dsDiscovery$CRMGender)
dsDiscovery[dsDiscovery$CRMGender == "U",]$CRMGender <- NA
table(dsDiscovery$CRMGender)
summary(dsDiscovery$CRMGender)
summary(dsDiscovery)
dsDiscovery[dsDiscovery$CRMCounty == "--"]$CRMCounty <-NA
dsDiscovery[dsDiscovery$CRMCounty == "--"]$CRMCounty <- NA
str(dsDiscovery)
dsDiscovery[dsDiscovery$CRMCounty == "--",]$CRMCounty <- NA
table(dsDiscovery$CRMCounty)
summary(dsDiscovery$CRMCounty)
summary(dsDiscovery)
summary(dsDiscovery$CRMZipCode)
dsDiscovery[dsDiscovery$CRMZipCode == "-----",]$CRMZipCode <- NA
summary(dsDiscovery$CRMZipCode)
dsDiscovery[dsDiscovery$CRMZipCode == "-----" | dsDiscovery$CRMZipCode == "(Other)",]$CRMZipCode <- NA
dsDiscovery[dsDiscovery$CRMZipCode == "-----" || dsDiscovery$CRMZipCode == "(Other)",]$CRMZipCode <- NA
dsDiscovery[dsDiscovery$CRMZipCode == "-----" or dsDiscovery$CRMZipCode == "(Other)",]$CRMZipCode <- NA
dsDiscovery <- rxImport(inData = "./data/DiscoveryAgents.xdf")
str(dsDiscovery)
summary(dsDiscovery)
dsDiscoveryClean <- dsDiscovery
?rxImport
library(dplyr)
dsDiscoveryClean[1:100,"CRMGender"]
junk<-dsDiscoveryClean[1:100,"CRMGender"]
junk
junk
junk$GenderRecoded <- junk$CRMGender
junk$GenderRecoded <- junk$CRMGender[,]
str(junk)
junk <- cbind(junk$CRMGender, "1")
junk[junk$CRMGender == "U",]
junk <- data.frame(dsDiscoveryClean[1:100, "CRMGender"])
str(junk)
head(junk)
head(junk,15)
names(junk)
names(junk,"Gender")
names(junk)
rename(junk, dsDiscoveryClean.1.100...CRMGender.. = Gender)
dplyr::rename(junk, dsDiscoveryClean.1.100...CRMGender.. = Gender)
dplyr::rename(junk, dsDiscoveryClean.1.100...CRMGender.. = "Gender")
?rename
rename(junk, Gender = dsDiscoveryClean.1.100...CRMGender..)
head(junk, 15)
junk<-rename(junk, Gender = dsDiscoveryClean.1.100...CRMGender..)
head(junk, 15)
junk %>% filter(Gender == "U")
junk %>% mutate(GenderRecoded = Gender)
?transform
head(dsDiscovery)
dsDiscovery[dsDiscovery$CRMCounty == "--",]$CRMCounty <- NA
head(dsDiscovery)
head(dsDiscoveryClean)$CRMGender
head(dsDiscoveryClean$CRMGender)
head(dsDiscoveryClean$CRMGender, 20)
dsDiscoveryClean[dsDiscoveryClean$CRMGender == "U",]$CRMGender <- NA
dsDiscoveryClean[dsDiscoveryClean$CRMCounty == "--",]$CRMCounty <- NA
head(dsDiscoveryClean$CRMGender, 20)
head(dsDiscoveryClean$CRMCounty, 20)
dsDiscoveryClean[dsDiscoveryClean$CRMZipCode == "-----",]$CRMZipCode <- NA
head(dsDiscovery$CRMCounty, 20)
head(dsDiscoveryClean$CRMCounty, 20)
head(dsDiscovery$CRMZipCode, 20)
head(dsDiscoveryClean$CRMZipCode, 20)
head(dsDiscovery$CRMState, 20)
head(dsDiscovery$CRMState, 55)
dsDiscoveryClean[dsDiscoveryClean$CRMState == "--",]$CRMState <- NA
head(dsDiscoveryClean$CRMState, 20)
str(dsDiscovery)
sConnection <- "Driver=SQL Server;Server=FL-TPA-BI-01.alg.local;Database=Amerilife_STG;UID=SQLserverR_user;PWD=Amerilife01"
sTable <- "staging.SSAS_Discovery_Typed"
dsDiscovery <- RxSqlServerData(connectionString = sConnection, table = sTable,      rowsPerRead = 10000,      stringsAsFactors = FALSE)
rxGetVarInfo(data = dsDiscovery)
# save the file locally in xdf format
rxDataStep(inData = dsDiscovery,      outFile = "./data/DiscoveryAgents.xdf",      overwrite = TRUE)
rm(list=ls())
dsDiscovery <- rxImport(inData = "./data/DiscoveryAgents.xdf")
str(dsDiscovery)
dsDiscoveryClean <- dsDiscovery
head(dsDiscovery$CRMGender, 50)
dsDiscoveryClean[dsDiscoveryClean$CRMGender == "U",]$CRMGender <- NA
head(dsDiscovery$CRMGender, 50)
dsDiscoveryClean$CRMGender == "U"
factor(dsDiscoveryClean$CRMGender, levelss = c("Male", "Female"), labels = c("M", "F"))
factor(dsDiscoveryClean$CRMGender, levels = c("Male", "Female"), labels = c("M", "F"))
head(dsDiscovery$CRMGender, 20)
head(dsDiscoveryClean$CRMGender, 20)
str(dsDiscovery)
as.factor(dsDiscoveryClean$CRMGender, levels = c("Male", "Female"), labels = c("M", "F"))
dsDiscoveryClean$CRMGender <- factor(dsDiscoveryClean$CRMGender, levels = c("Male", "Female"), labels = c("M", "F"))
str(dsDiscovery)
str(dsDiscoveryClean)
dsDiscoveryClean <- dsDiscovery
str(dsDiscoveryClean)
dsDiscoveryClean[dsDiscoveryClean$CRMGender == "U",]$CRMGender <- NA
factor(dsDiscoveryClean$CRMGender, levels = c("Male", "Female"), labels = c("M", "F"))
str(dsDiscoveryClean)
dsDiscoveryClean$CRMGender <- factor(dsDiscoveryClean$CRMGender, levels = c("Male", "Female"), labels = c("M", "F"))
str(dsDiscoveryClean)
table(dsDiscovery$CRMGender)
table(dsDiscoveryClean$CRMGender)
head(dsDiscoveryClean$CRMGender, 20)
table(dsDiscoveryClean$CRMGender, useNA = "yes")
table(dsDiscoveryClean$CRMGender, useNA = TRUE)
table(dsDiscoveryClean$CRMGender, useNA = c("always") )
table(dsDiscovery$CRMGender)
table(dsDiscoveryClean$CRMGender, useNA = c("always"))
sConnection <- "Driver=SQL Server;Server=FL-TPA-BI-01.alg.local;Database=Amerilife_STG;UID=SQLserverR_user;PWD=Amerilife01"
dsDiscovery <- RxSqlServerData(connectionString = sConnection,     sqlQuery = "select * from staging.SSAS_Discovery_Typed",     rowsPerRead = 10000,     stringsAsFactors = FALSE)
dsDiscovery <- RxSqlServerData(connectionString = sConnection,     sqlQuery = "select * from staging.SSAS_Discovery_Typed",     rowsPerRead = 10000,     stringsAsFactors = FALSE)
rxDataStep(inData = dsDiscovery,      outFile = "./data/DiscoveryAgents.xdf",      overwrite = TRUE)
dsDiscoveryClean$CRMCounty <- factor(dsDiscoveryClean$CRMCounty)
table(dsDiscovery$CRMCounty)
table(dsDiscovery$CRMCounty)
table(dsDiscovery$CRMGender)
table(dsDiscoveryClean$CRMGender, useNA = c("always"))
table(dsDiscoveryClean$CRMCounty, useNA = c("always"))
dsDiscoveryClean[dsDiscoveryClean$CRMCounty == "--",]$CRMCounty <- NA
table(dsDiscoveryClean$CRMCounty, useNA = c("always"))
names(dsDiscoveryClean$CRMCounty)
dsDiscoveryClean$CRMCounty <- factor(dsDiscoveryClean$CRMCounty)
names(dsDiscoveryClean$CRMCounty)
levels(dsDiscoveryClean$CRMCounty)
table(dsDiscoveryClean$CRMCounty, useNA = c("always"))
str(dsDiscoveryClean)
head(dsDiscovery$CRMState, 20)
head(dsDiscoveryClean$CRMState, 20)
head(dsDiscovery$CRMState, 20)
head(dsDiscoveryClean$CRMGState, 100)
head(dsDiscoveryClean$CRMGState)
head(dsDiscoveryClean$CRMState, 100)
str(dsDiscoveryClean)
dsDiscoveryClean$CRMState <- factor(dsDiscoveryClean$CRMState)
str(dsDiscoveryClean)
dsDiscoveryClean[dsDiscoveryClean$CRMState == "--",]$CRMState <- NA
levels(dsDiscoveryClean$CRMState)
str(dsDiscoveryClean)
dsDiscoveryClean$CRMCounty <- factor(dsDiscoveryClean$CRMCounty)
str(dsDiscoveryClean)
head(dsDiscoveryCleand[dsDiscoveryClean$CRMState == "--",])
head(dsDiscoveryClean[dsDiscoveryClean$CRMState == "--",])
head(dsDiscoveryClean$CRMState, 100)
dsDiscoveryClean <- dsDiscovery
str(dsDiscoveryClean)
dsDiscoveryClean[dsDiscoveryClean$CRMGender == "U",]$CRMGender <- NA
rm(list = c("dsDiscoveryClean"))
dsDiscoveryClean <- dsDiscovery
str(dsDiscoveryClean)
dsDiscoveryClean[dsDiscoveryClean$CRMGender == "U",]$CRMGender <- NA
rxGetVarInfo(dsDiscoveryClean)
dsDiscoveryClean[dsDiscoveryClean$CRMGender == "U",]$CRMGender <- NA
dsDiscoveryClean <- data.frame(dsDiscovery)
